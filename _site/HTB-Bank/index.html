<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.15.1 by Michael Rose
  Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>HTB-Bank - creep33.github.io</title>
<meta name="description" content="WriteUp con metodología de la máquina Bank.">



<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="creep33.github.io">
<meta property="og:title" content="HTB-Bank">
<meta property="og:url" content="http://localhost:4000/HTB-Bank/">


  <meta property="og:description" content="WriteUp con metodología de la máquina Bank.">



  <meta property="og:image" content="http://localhost:4000/assets/images/WriteUps/Bank.png">





  <meta property="article:published_time" content="2021-12-28T00:00:00+01:00">





  

  


<link rel="canonical" href="http://localhost:4000/HTB-Bank/">







  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "creep33",
      "url": "http://localhost:4000",
      "sameAs": null
    }
  </script>







<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="creep33.github.io Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">

<!--[if IE ]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single wide">

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
          <a class="site-logo" href="/"><img src="/assets/images/masthead.png" alt=""></a>
                
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/" >Home</a>
            </li><li class="masthead__menu-item">
              <a href="/posts/" >Posts</a>
            </li><li class="masthead__menu-item">
              <a href="/categories/" >Categories</a>
            </li><li class="masthead__menu-item">
              <a href="/search/" >Search</a>
            </li><li class="masthead__menu-item">
              <a href="/about/" >About</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>
    

    <div class="initial-content">
      


  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="http://localhost:4000/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">HTB-Bank</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      

      
        <img src="/assets/images/avatar.png" alt="creep33" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">creep33</h3>
    
    
      <p class="author__bio" itemprop="description">
        eJPT | Cibersecurity and<br>Ethical Hacking Student
      </p>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Spain</span>
        </li>
      

      

      

      

      

      

      

      

      
        <li>
          <a href="https://www.linkedin.com/in/mario-mansilla-fernández-2b7086231" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn
          </a>
        </li>
      

      

      

      

      

      
        <li>
          <a href="https://github.com/creep33" itemprop="sameAs" rel="nofollow noopener noreferrer">
            <i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub
          </a>
        </li>
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>


  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="HTB-Bank">
    <meta itemprop="description" content="WriteUp con metodología de la máquina Bank.">
    <meta itemprop="datePublished" content="December 28, 2021">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">HTB-Bank
</h1>
          
        </header>
      

      <section class="page__content" itemprop="text">
        
        <p class="page__meta">
          
            <i class="fa fa-fw fa-calendar" aria-hidden="true"></i> <time datetime="2021-12-28T00:00:00+01:00">December 28, 2021 </time>&emsp;
          
          
        </p>
        <center><img src="/assets/images/WriteUps/Bank.png" /></center>

<p>IP -&gt; 10.10.10.29</p>

<h1 id="reconocimiento">Reconocimiento</h1>
<h2 id="nmap">Nmap</h2>
<p>Utilizamos <a href="/Nmap/">nmap</a> y obtenemos los siguientes resultados.</p>

<p><a href="/assets/files/WriteUps/Bank.txt">Bank Nmap Result</a></p>

<h2 id="http">http</h2>
<h3 id="whatweb">whatweb</h3>
<p>Utilizamos <a href="/whatweb/">whatweb</a> para extraer informacion pero no obtenemos ninguna información relevante.</p>

<h3 id="virtual-hosting">Virtual Hosting</h3>
<p>Probamos a ver si se está realizando virtual hosting. Con el dominio “bank.htb”.</p>

<blockquote>
  <p>Añadimos en dominio “bank.htb” al /etc/hosts</p>
</blockquote>

<h4 id="bankhtb">bank.htb</h4>
<p>Vemos un panel de inicio de sesión. Probamos credenciales por defecto pero no conseguimos nada.</p>

<h5 id="fuzzing">Fuzzing</h5>
<p>Fuzzeamos el servicio http con herramientas como <a href="/wfuzz/">wfuzz</a> o <a href="/gobuster/">gobuster</a>. Y obtenemos los siguientes resultados.</p>

<blockquote>
  <p>/uploads -&gt; 403
/assets -&gt; Unrelevant directories 
/inc -&gt; 4 php scripts
/balance-transfer -&gt; Lots of .acc files.</p>
</blockquote>

<p>Vamos a filtrar para ver si hay algun fichero que pese un valor que se sale de la media en /balance-transfer</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl <span class="nt">-s</span> <span class="nt">-X</span> GET <span class="s2">"http://bank.htb/balance-transfer"</span> | <span class="nb">grep</span> <span class="nt">-oP</span> <span class="s1">'[a-z0-9]{32}\.acc.*"right".+\s'</span> | <span class="nb">awk</span> <span class="s1">'{print $1 "-&gt;" $7}'</span> <span class="nv">FS</span><span class="o">=</span><span class="s2">"&gt;"</span> | <span class="nb">tr</span> <span class="nt">-d</span> <span class="s1">'"'</span> | <span class="nb">sort</span> <span class="nt">-k3</span> <span class="nt">-n</span>
</code></pre></div></div>

<blockquote>
  <p>68576f20e9732f1b2edc4df5b8533230.acc-&gt; 257
USER: cris\@bank.htb
PASS: !##HTBB4nkP4ssw0rd!##</p>
</blockquote>

<p>Iniciamos sesión en el panel de inicio de sesión.</p>

<blockquote>
  <p>Panel de “Support”</p>
</blockquote>

<p>Nos permiten subir un archivo al reportar un ticket. Probamos a hacre un ticket de prueba. Y nos reporta que solo podemos subir imágenes. Al subir una imágen vemos que el directorio /uploads es donde se almacenan las imágenes.</p>

<ul>
  <li>Tratamos de subir un archivo php ya que la página funciona con php.</li>
</ul>

<p>Pero nos reporta que tenemos que subir imágenes.</p>

<h5 id="burpsuite">Burpsuite</h5>
<p>Utilizaremos Burpsuite para analizar como se tramite la data.
Al realizar la petición vemos que en la respuesta, hay un comentario que dice que los archivos .htb lo interpreta con php.</p>
<ul>
  <li>Subimos un script en php con extensión htb</li>
</ul>

<blockquote>
  <p>WebShell</p>
</blockquote>

<p>Nos enviamos una reverse shell.</p>

<h2 id="domain">Domain</h2>
<p>Probamos un ataque de transferencia de zona con la herramienta dig sobre el dominio “bank.htb” ya que es un convenio de HTB.</p>

<blockquote>
  <p>DNS: chris.bank.htb -&gt; No vemos nada nuevo</p>
</blockquote>

<h1 id="privesc">PrivEsc</h1>
<h2 id="os">OS</h2>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">whoami
hostname</span> <span class="nt">-I</span>
<span class="nb">cd</span> /home
<span class="nb">ls
cd </span>chris
<span class="nb">ls
cat </span>user.txt
</code></pre></div></div>

<blockquote>
  <p>user.txt</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /
find <span class="se">\-</span>perm <span class="nt">-4000</span> 2&gt;/dev/null
</code></pre></div></div>

<blockquote>
  <p>./var/htb/bin/emergency -&gt; Binario compilado de 32 bits SUID</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/var/htb/bin/emergency
</code></pre></div></div>

<p>Lo ejecutamos y somos root</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cd</span> /root
<span class="nb">cat </span>root.txt
</code></pre></div></div>

<blockquote>
  <p>root.txt</p>
</blockquote>

<h1 id="alt-way">Alt-way</h1>
<p>Otra forma de escalar privilegios sería modificar el archvo /etc/passwd ya que “otros” pueden editar el archivo para incrustarle una contraseña a root.
Ex:</p>
<ul>
  <li><a href="/HTB-Ghoul/">Ghoul</a></li>
</ul>

<hr />

<p>Escrito el 28-12-2021 a las 05:47 pm por creep33.</p>

        
      </section>

      <footer class="page__meta">
        
        
  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/tags/#htb" class="page__taxonomy-item" rel="tag">HTB</a>
    
    </span>
  </p>




  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categories/#writeups" class="page__taxonomy-item" rel="tag">WriteUps</a>
    
    </span>
  </p>


        
          <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-12-28T00:00:00+01:00">December 28, 2021</time></p>
        
      </footer>

      

      
  <nav class="pagination">
    
      <a href="/pop3/" class="pagination--pager" title="POP3
">Previous</a>
    
    
      <a href="/HTB-Wall/" class="pagination--pager" title="HTB-Wall
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
</div>

    </div>

    

    <div class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    

    <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 creep33</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>
  <script data-search-pseudo-elements defer src="https://use.fontawesome.com/releases/v5.7.1/js/all.js" integrity="sha384-eVEQC9zshBn0rFj4+TU78eNA19HMNigMviK/PU/FFjLXqa/GKPgX58rvt5Z8PLs7" crossorigin="anonymous"></script>








  </body>
</html>
